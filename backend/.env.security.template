# SaaS X-Ray Security Configuration Template
# Copy this file to .env and fill in your secure values

# ============================================================================
# ENCRYPTION SETTINGS
# ============================================================================

# Master encryption key - MUST be at least 64 characters (256 bits)
# Generate with: openssl rand -hex 64
MASTER_ENCRYPTION_KEY=your-256-bit-master-encryption-key-here-must-be-64-chars-minimum

# Encryption salt for key derivation
# Generate with: openssl rand -base64 32
ENCRYPTION_SALT=your-encryption-salt-here

# Key rotation settings
KEY_ROTATION_DAYS=90
KEY_DERIVATION_ROUNDS=600000
BACKUP_RETENTION_DAYS=365

# Additional encryption keys for rotation (optional)
# ENCRYPTION_KEY_1=your-additional-key-1
# ENCRYPTION_KEY_2=your-additional-key-2

# ============================================================================
# JWT AUTHENTICATION SETTINGS
# ============================================================================

# RSA key pair for JWT signing (recommended: 2048-bit or higher)
# Generate private key: openssl genrsa -out jwt-private.pem 2048
# Generate public key: openssl rsa -in jwt-private.pem -pubout -out jwt-public.pem
# Then convert to single-line format for environment variables

JWT_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nYOUR_PRIVATE_KEY_HERE\n-----END PRIVATE KEY-----"
JWT_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----\nYOUR_PUBLIC_KEY_HERE\n-----END PUBLIC KEY-----"

# Token lifetimes
ACCESS_TOKEN_TTL=15m
REFRESH_TOKEN_TTL=7d

# Session management
MAX_CONCURRENT_SESSIONS=5
SESSION_TIMEOUT_MINUTES=60

# ============================================================================
# OAUTH SETTINGS
# ============================================================================

# OAuth state and callback settings
OAUTH_STATE_EXPIRATION=10
OAUTH_MAX_CALLBACK_ATTEMPTS=3
TOKEN_REFRESH_BUFFER_MINUTES=10
SUPPORTED_OAUTH_PLATFORMS=slack,google,microsoft

# Slack OAuth (from Slack App settings)
SLACK_CLIENT_ID=your-slack-client-id
SLACK_CLIENT_SECRET=your-slack-client-secret
SLACK_SIGNING_SECRET=your-slack-signing-secret
SLACK_REDIRECT_URI=http://localhost:3001/api/auth/callback/slack

# Google OAuth (from Google Cloud Console)
GOOGLE_CLIENT_ID=your-google-client-id.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_REDIRECT_URI=http://localhost:3001/api/auth/callback/google

# Microsoft OAuth (from Azure App Registration)
MICROSOFT_CLIENT_ID=your-microsoft-application-id
MICROSOFT_CLIENT_SECRET=your-microsoft-client-secret
MICROSOFT_TENANT_ID=your-microsoft-tenant-id
MICROSOFT_REDIRECT_URI=http://localhost:3001/api/auth/callback/microsoft

# ============================================================================
# RATE LIMITING
# ============================================================================

# General API rate limits
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Authentication rate limits (stricter)
AUTH_RATE_LIMIT_WINDOW_MS=900000
AUTH_RATE_LIMIT_MAX_REQUESTS=5

# API endpoint rate limits
API_RATE_LIMIT_WINDOW_MS=60000
API_RATE_LIMIT_MAX_REQUESTS=60

# ============================================================================
# SECURITY POLICIES
# ============================================================================

# Login security
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=30

# Password policy
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=true
PASSWORD_PREVENT_REUSE=5

# Session security
REQUIRE_HTTPS=true
SAME_SITE_COOKIE=strict
HTTP_ONLY_COOKIE=true
SECURE_COOKIE_FLAG=true

# ============================================================================
# MONITORING AND ALERTING
# ============================================================================

# Alert thresholds
ALERT_FAILED_LOGINS_PER_MINUTE=10
ALERT_SUSPICIOUS_REQUESTS_PER_MINUTE=20
ALERT_ERROR_RATE_PERCENTAGE=5
ALERT_RESPONSE_TIME_MS=5000

# Audit and retention
AUDIT_RETENTION_DAYS=2555
REAL_TIME_MONITORING=true

# ============================================================================
# COMPLIANCE SETTINGS
# ============================================================================

# GDPR Compliance
GDPR_COMPLIANCE=true
GDPR_DATA_RETENTION_DAYS=2555
GDPR_ANONYMIZATION_DELAY=30

# SOC 2 Compliance
SOC2_COMPLIANCE=true
SOC2_AUDITING_LEVEL=detailed
SOC2_ENCRYPTION_AT_REST=true
SOC2_ENCRYPTION_IN_TRANSIT=true

# OWASP Security
OWASP_COMPLIANCE=true
OWASP_SECURITY_HEADERS=true
OWASP_CSP=true
OWASP_XSS_PROTECTION=true

# ============================================================================
# APPLICATION URLs
# ============================================================================

# Frontend and API URLs for CORS and redirects
FRONTEND_URL=http://localhost:3000
API_URL=http://localhost:3001

# Allowed domains for CORS (comma-separated)
ALLOWED_ORIGINS=http://localhost:3000,https://app.saas-xray.com

# ============================================================================
# ADVANCED SECURITY FEATURES
# ============================================================================

# Advanced threat detection
ENABLE_ADVANCED_THREAT_DETECTION=true
ENABLE_BEHAVIORAL_ANALYSIS=true
ENABLE_REAL_TIME_ALERTS=true

# Compliance modes
HIPAA_COMPLIANCE=false

# Development features (set to false in production)
ENABLE_SECURITY_TESTING=false
ENABLE_VULNERABILITY_SCANNING=false
PENETRATION_TESTING_MODE=false

# Emergency controls
EMERGENCY_SHUTDOWN=false

# ============================================================================
# DATABASE SECURITY
# ============================================================================

# Database connection with SSL
DB_SSL_MODE=require
DB_SSL_CERT_PATH=/path/to/client-cert.pem
DB_SSL_KEY_PATH=/path/to/client-key.pem
DB_SSL_CA_PATH=/path/to/ca-cert.pem

# Connection pool security
DB_MAX_CONNECTIONS=20
DB_CONNECTION_TIMEOUT_MS=30000
DB_IDLE_TIMEOUT_MS=600000

# ============================================================================
# EXTERNAL SERVICES
# ============================================================================

# Redis for session storage (if using)
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=your-redis-password
REDIS_TLS=true

# External logging service (optional)
LOG_SERVICE_URL=https://your-log-service.com/api/logs
LOG_SERVICE_API_KEY=your-log-service-api-key

# Email service for security alerts (optional)
SMTP_HOST=your-smtp-host
SMTP_PORT=587
SMTP_USERNAME=your-smtp-username
SMTP_PASSWORD=your-smtp-password
SECURITY_ALERT_EMAIL=security@your-domain.com

# ============================================================================
# PRODUCTION OVERRIDES
# ============================================================================
# These values will be different in production - store in secure vault

# Production encryption keys
# PROD_MASTER_ENCRYPTION_KEY=your-production-master-key
# PROD_JWT_PRIVATE_KEY=your-production-jwt-private-key
# PROD_JWT_PUBLIC_KEY=your-production-jwt-public-key

# Production OAuth credentials
# PROD_SLACK_CLIENT_SECRET=your-production-slack-secret
# PROD_GOOGLE_CLIENT_SECRET=your-production-google-secret
# PROD_MICROSOFT_CLIENT_SECRET=your-production-microsoft-secret

# Production URLs
# PROD_FRONTEND_URL=https://app.saas-xray.com
# PROD_API_URL=https://api.saas-xray.com
# PROD_ALLOWED_ORIGINS=https://app.saas-xray.com,https://saas-xray.com

# ============================================================================
# SECURITY CHECKLIST
# ============================================================================
# Before deploying to production:
# [ ] All encryption keys are randomly generated and stored securely
# [ ] JWT keys are properly generated RSA key pairs
# [ ] OAuth credentials are from production apps, not development
# [ ] HTTPS is enforced (REQUIRE_HTTPS=true)
# [ ] Rate limits are appropriate for your traffic
# [ ] Compliance settings match your requirements
# [ ] Monitoring and alerting are configured
# [ ] Database connections use SSL
# [ ] Secrets are stored in a secure vault, not in code
# [ ] Regular security audits are scheduled
# [ ] Incident response procedures are documented